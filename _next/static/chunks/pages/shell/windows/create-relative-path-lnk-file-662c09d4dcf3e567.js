(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[747],{3222:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shell/windows/create-relative-path-lnk-file",function(){return r(5952)}])},8167:function(e,s,r){"use strict";r.d(s,{Z:function(){return i}});var n=r(5893);r(7294);let l="/code-snippet-book",o={logo:(0,n.jsx)(function(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("img",{src:"".concat(l,"/favicon/favicon-16x16.png"),style:{marginBottom:2}}),(0,n.jsx)("span",{style:{marginLeft:8},children:(0,n.jsx)("b",{style:{backgroundImage:"linear-gradient(to right, #cb3f49, purple)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"LK CS Book"})})]})},{}),head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,n.jsx)("meta",{property:"og:title",content:"LK CS Book"}),(0,n.jsx)("link",{rel:"icon",href:"".concat(l,"/favicon/favicon-16x16.png")})]}),project:{link:"https://github.com/likianta/code-snippet-book"},docsRepositoryBase:"https://github.com/likianta/code-snippet-book",footer:{text:"Made by Likiata, powered by Nextra"}};var i=o},5952:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return y}});var n=r(5893),l=r(2673),o=r(1712),i=r(8167);r(9966);var t=r(1151),a=r(5675),c=r.n(a),h={src:"/code-snippet-book/_next/static/media/000250.3f9fcf0e.png",height:159,width:1006,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAABCAMAAADU3h9xAAAAD1BMVEVQSkpKRkZeW1tCPz83NDRD23IrAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAEUlEQVR4nGNgYmRgYGRmYQIAADcADkQgFNkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:1},d={src:"/code-snippet-book/_next/static/media/000322.ab7a563b.png",height:238,width:469,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAECAMAAACEE47CAAAAD1BMVEX7/Pz29vXw8fLk5ufO2uPIlSxJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIElEQVR4nCXIsQEAMAyDMMD5/+YO1ShMBTBbQqvb4D88AxEAKJAr7CgAAAAASUVORK5CYII=",blurWidth:8,blurHeight:4},k={src:"/code-snippet-book/_next/static/media/000344.b925e97d.png",height:677,width:538,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAMAAADtGH4KAAAAD1BMVEXz8/P5+Pjw7+/o6e3V3+yrSHJWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAJ0lEQVR4nB2KQQ4AAAiCEPv/m1t5gQ2xgFRutu1hZkSThE/hPPm3LAhZAEOT2/QKAAAAAElFTkSuQmCC",blurWidth:6,blurHeight:8};let p={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,t.ah)(),e.components);return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(x,{...e})}):x(e)},pageOpts:{filePath:"pages/shell/windows/create-relative-path-lnk-file.mdx",route:"/shell/windows/create-relative-path-lnk-file",headings:[{depth:1,value:"Windows 通过 BAT 脚本创建相对路径的快捷方式",id:"windows-通过-bat-脚本创建相对路径的快捷方式"},{depth:2,value:"快速开始",id:"快速开始"},{depth:2,value:"源代码及详细注释",id:"源代码及详细注释"},{depth:2,value:"截图",id:"截图"},{depth:2,value:"注意事项",id:"注意事项"},{depth:2,value:"扩展用法",id:"扩展用法"},{depth:3,value:"在 Python 中调用",id:"在-python-中调用"},{depth:2,value:"参考",id:"参考"}],timestamp:1688626056e3,pageMap:[{kind:"Meta",data:{index:{title:"Home",type:"page"},python:{title:"Python",type:"page"},shell:{title:"Shell",type:"page"}}},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"python",route:"/python",children:[{kind:"Meta",data:{"qt-pyside-pyqt":"Qt PySide PyQt","get-file-hash":"Get File Hash","get-file-size":"Get File Size","get-func-source":"Get Func Source","load-module-by-path":"Load Module by Path","pip-commonly-used":"Pip Commonly Used","poetry-memo":"Poetry Memo",streamlit:"Streamlit","watch-file-changes":"Watch File Changes",xlsxwriter:"Xlsxwriter",zipfiles:"Zipfiles"}},{kind:"MdxPage",name:"get-file-hash",route:"/python/get-file-hash"},{kind:"MdxPage",name:"get-file-size",route:"/python/get-file-size"},{kind:"MdxPage",name:"get-func-source",route:"/python/get-func-source"},{kind:"MdxPage",name:"load-module-by-path",route:"/python/load-module-by-path"},{kind:"MdxPage",name:"pip-commonly-used",route:"/python/pip-commonly-used"},{kind:"MdxPage",name:"poetry-memo",route:"/python/poetry-memo"},{kind:"Folder",name:"qt-pyside-pyqt",route:"/python/qt-pyside-pyqt",children:[{kind:"Meta",data:{qml:"QML","auto-wrap-in-treewiget-cell":"Auto Wrap in Treewiget Cell"}},{kind:"MdxPage",name:"auto-wrap-in-treewiget-cell",route:"/python/qt-pyside-pyqt/auto-wrap-in-treewiget-cell"},{kind:"Folder",name:"qml",route:"/python/qt-pyside-pyqt/qml",children:[{kind:"MdxPage",name:"horizontal-scroll",route:"/python/qt-pyside-pyqt/qml/horizontal-scroll"},{kind:"MdxPage",name:"reactangle-radius-clip",route:"/python/qt-pyside-pyqt/qml/reactangle-radius-clip"},{kind:"Meta",data:{"horizontal-scroll":"Horizontal Scroll","reactangle-radius-clip":"Reactangle Radius Clip"}}]}]},{kind:"MdxPage",name:"streamlit",route:"/python/streamlit"},{kind:"MdxPage",name:"watch-file-changes",route:"/python/watch-file-changes"},{kind:"MdxPage",name:"xlsxwriter",route:"/python/xlsxwriter"},{kind:"MdxPage",name:"zipfiles",route:"/python/zipfiles"}]},{kind:"Folder",name:"shell",route:"/shell",children:[{kind:"MdxPage",name:"bore-frp",route:"/shell/bore-frp"},{kind:"MdxPage",name:"chrome-app-mode",route:"/shell/chrome-app-mode"},{kind:"MdxPage",name:"ssh-keygen",route:"/shell/ssh-keygen"},{kind:"Folder",name:"windows",route:"/shell/windows",children:[{kind:"MdxPage",name:"create-relative-path-lnk-file",route:"/shell/windows/create-relative-path-lnk-file"},{kind:"Meta",data:{"create-relative-path-lnk-file":"Create Relative Path Lnk File"}}]},{kind:"Meta",data:{"bore-frp":"Bore Frp","chrome-app-mode":"Chrome App Mode","ssh-keygen":"Ssh Keygen"}}]}],flexsearch:{codeblocks:!0},title:"Windows 通过 BAT 脚本创建相对路径的快捷方式"},pageNextRoute:"/shell/windows/create-relative-path-lnk-file",nextraLayout:o.ZP,themeConfig:i.Z};function x(e){let s=Object.assign({h1:"h1",p:"p",ul:"ul",li:"li",h2:"h2",pre:"pre",code:"code",span:"span",blockquote:"blockquote",strong:"strong",a:"a",h3:"h3"},(0,t.ah)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{children:"Windows 通过 BAT 脚本创建相对路径的快捷方式"}),"\n",(0,n.jsx)(s.p,{children:"网上没有找到相关的结果. 这是我综合多个答案的线索找到的一个简单有效的方案."}),"\n",(0,n.jsx)(s.p,{children:"本文解决以下问题:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"bat 怎么创建快捷方式"}),"\n",(0,n.jsx)(s.li,{children:"快捷方式需要带上图标"}),"\n",(0,n.jsx)(s.li,{children:"快捷方式怎么用相对路径 (这样可以把快捷方式的启动器放入自己的应用, 打包发给别人也能使用)"}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"注: 该教程的目的是帮助开发者快速封装自己的 bat 启动器为 lnk 格式, 并添加自己的启动器图标, 提升应用美观性."}),"\n",(0,n.jsx)(s.h2,{id:"快速开始",children:"快速开始"}),"\n",(0,n.jsx)(s.p,{children:'直接拷贝下个章节提供的源代码, 保存为 "create_relative_shortcut.bat" 文件. 通过 cmd 调用:'}),"\n",(0,n.jsx)(s.pre,{"data-language":"bat","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"bat","data-theme":"default",children:[(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"# 使用示例"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"create_relative_shortcut.bat E:\\test\\my_script.bat E:\\test\\my_script.lnk my_script.bat E:\\test\\launcher.ico"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"# 命令格式: create_relative_shortcut.bat "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"file_i"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"file_o"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"relative_path"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"<"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"icon"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    # relative_path:"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        # 相对路径, 推荐使用 file_i 相对于 file_o 的路径."})}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        # 在本示例中, 生成的相对路径指向 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"./my_script.bat"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        # 该参数可自定义, 也可以传一个事先不存在的路径. 例如, 填 "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"..\\my_script.bat"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:", "})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        # 则生成的快捷方式在启动时会往它的上级目录找 my_script.bat."})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    # icon:"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"        # 这是一个可选参数. 如果不传这个参数, 则使用快捷方式的默认图标."})})]})}),"\n",(0,n.jsx)(s.p,{children:"大概不到 1 秒即可生成."}),"\n",(0,n.jsx)(s.h2,{id:"源代码及详细注释",children:"源代码及详细注释"}),"\n",(0,n.jsxs)(s.blockquote,{children:["\n",(0,n.jsx)(s.p,{children:"注意: 下面放了有注释版和无注释版的源代码, 经个人测试有注释版的因不明原因运行到一半就结束了; 无注释版的可以正常使用. 该问题正在修复中, 在修复完成前, 请复制无注释版的源码保存."}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"create_relative_shortcut.bat (有注释版)"}),"\n",(0,n.jsx)(s.pre,{"data-language":"bat","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"bat","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 关闭打印"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"off"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 接收传入的参数"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_i"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%1"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_o"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%2"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" relative_path"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%3"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" icon"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%4"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 由于 icon 是可选参数, 如果用户没有传值, 则 icon 会变成 '%4', 这里要处理下."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" %icon%"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"findstr"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" .ico "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"nul"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"||"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" icon"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" invalid icon or no icon passed, will ignore it."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 切换到当前目录 (注: 该操作不是必须的)."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"cd"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" %cd%"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 创建一个临时的 vbs 脚本, 写入以下内容."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 创建一个 wscript.shell 对象."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" set wshell = WScript.CreateObject("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"WScript.Shell"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 在 vbs 脚本中声明 file_o 变量."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_o = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%file_o%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 创建一个 shortcut 对象."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" set shortcut = wshell.CreateShortcut(file_o) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 下面开始设置 shortcut 对象的属性."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 1. 将目标路径设置为 cmd.exe. 我们可以用 %comspec% 或者 "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    %windir%\\system32\\cmd.exe 来表示."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.TargetPath = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%comspec%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 2. cmd.exe /c relative_path 该指令用于在 cmd.exe 中执行目标 bat 文件."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    /c 参数表示执行完关闭 cmd. 更多请参考此链接: "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"        https://blog.csdn.net/halaoda/article/details/78778477"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Arguments = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/c %relative_path%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:' 3. 将 "快捷方式所在目录" 设置为起始目录 (这样相对路径才能相对于快捷方式的'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    位置来查找)."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:'    注意这里双写百分号用来避免百分号被转义 (即双写百分号表示单个 "%").'})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.WorkingDirectory = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%%cd%%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 4. 添加快捷方式描述 (可选)."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Description = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 5. 添加快捷方式图标 (可选)."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.IconLocation = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%icon%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 6. 保存 vbs 脚本."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Save() "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 执行 vbs 脚本."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"cscript"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"REM"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" 删除临时的 vbs 脚本."})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"del"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]})]})}),"\n",(0,n.jsx)(s.p,{children:"create_relative_shortcut.bat (无注释版)"}),"\n",(0,n.jsx)(s.pre,{"data-language":"bat","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"bat","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"@echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"off"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_i"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%1"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_o"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%2"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" relative_path"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%3"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" icon"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"%4"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" %icon%"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"|"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"findstr"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" .ico "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"nul"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"||"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ("})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"set"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" icon"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"&&"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" invalid icon or no icon passed, will ignore it."})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:")"})}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"cd"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" %cd%"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" set wshell = WScript.CreateObject("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"WScript.Shell"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:") "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" file_o = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%file_o%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" set shortcut = wshell.CreateShortcut(file_o) "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.TargetPath = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%comspec%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Arguments = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"/c %relative_path%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.WorkingDirectory = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%%cd%%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Description = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'""'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.IconLocation = "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"%icon%"'}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"echo"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" shortcut.Save() "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:">>"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:" "}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"cscript"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"del"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" create_shortcut.vbs"})]})]})}),"\n",(0,n.jsx)(s.h2,{id:"截图",children:"截图"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(c(),{placeholder:"blur",src:h})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(c(),{placeholder:"blur",src:d})}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(c(),{placeholder:"blur",src:k})}),"\n",(0,n.jsx)(s.h2,{id:"注意事项",children:"注意事项"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"icon 的文件类型必须为 .ico 格式"})}),"\n",(0,n.jsxs)(s.p,{children:["快捷方式图标仅支持 ico 格式. 如果手上只有 png, jpg 等格式, 请通过 ",(0,n.jsx)(s.a,{href:"https://www.aconvert.com/cn/image/",children:"在线网站"})," 转换."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"icon 必须使用绝对路径"})}),"\n",(0,n.jsx)(s.p,{children:"不知道是不是个人现象, icon 参数似乎必须传绝对路径, 否则无法正确生成图标."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"第三方文件管理器问题"})}),"\n",(0,n.jsx)(s.p,{children:"如果你使用的是 windows 第三方文件管理器 (如 xyplorer, clover 等), 则有可能会出现 lnk 打开闪退的问题. 但是换用 windows 自带管理器是正常使用的."}),"\n",(0,n.jsx)(s.p,{children:"这是因为 xyplorer 的 cmd.exe 进程是不同步的, 请尝试重启 xyplorer 解决."}),"\n",(0,n.jsx)(s.h2,{id:"扩展用法",children:"扩展用法"}),"\n",(0,n.jsx)(s.h3,{id:"在-python-中调用",children:"在 Python 中调用"}),"\n",(0,n.jsx)(s.pre,{"data-language":"python","data-theme":"default",hasCopyCode:!0,children:(0,n.jsxs)(s.code,{"data-language":"python","data-theme":"default",children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" os"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" lk_utils "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" run_cmd_args  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"# pip install lk-utils"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"run_cmd_args"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"r"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'E:\\test\\create_relative_shortcut"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"bat'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:", "})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    file_i "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"r"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'E:\\test\\hello_world"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"bat'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    file_o "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"r"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'E:\\test\\hello_world"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"bat'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    os.path."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"relpath"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(file_i, os.path."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"dirname"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"(file_o)),"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"    os.path."}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"abspath"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:"("}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'launcher.ico'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:")"})})]})}),"\n",(0,n.jsx)(s.h2,{id:"参考",children:"参考"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["Bat 通过 VBS 嵌入式脚本创建快捷方式: ",(0,n.jsx)(s.a,{href:"https://stackoverflow.com/questions/30028709/how-do-i-create-a-shortcut-via-command-line-in-windows",children:"https://stackoverflow.com/questions/30028709/how-do-i-create-a-shortcut-via-command-line-in-windows"})]}),"\n",(0,n.jsxs)(s.li,{children:["VBS, WScript.Shell, CreateShortcut 更多参数用法: ",(0,n.jsx)(s.a,{href:"https://stackoverflow.com/questions/35783889/make-relative-shortcut-to-relative-target",children:"https://stackoverflow.com/questions/35783889/make-relative-shortcut-to-relative-target"})]}),"\n"]})]})}var y=(0,l.j)(p)}},function(e){e.O(0,[774,568,888,179],function(){return e(e.s=3222)}),_N_E=e.O()}]);